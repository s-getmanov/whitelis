<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\Publication;
use App\Models\User;
use Carbon\Carbon;

class PublicationsSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        // Получаем пользователей для авторов
        $admin = User::where('role', 'admin')->first();
        
        if (!$admin) {
            $admin = User::create([
                'name' => 'Администратор',
                'email' => 'admin@beliy-lis.ru',
                'password' => bcrypt('password'),
                'role' => 'admin',
                'status' => 'active'
            ]);
        }

        $publications = [
            // Новости (опубликованные)
            [
                'title' => 'Открытие зимнего сезона лыжных гонок',
                'slug' => 'otkrytie-zimnego-sezona-lyzhnyh-gonok',
                'excerpt' => 'Стартовал зимний сезон лыжных гонок. Приглашаем всех желающих принять участие в соревнованиях.',
                'content' => '<h2>Дорогие спортсмены и любители лыжного спорта!</h2>
<p>Рады сообщить, что зимний сезон лыжных гонок официально открыт. В этом году мы подготовили для вас:</p>
<ul>
<li>Соревнования для всех возрастных категорий</li>
<li>Дистанции от 5 до 21 км</li>
<li>Отдельные зачеты для мужчин и женщин</li>
<li>Командное первенство</li>
</ul>
<p>Первые соревнования состоятся 15 января на лыжной базе "Снежинка".</p>
<p>Регистрация уже открыта в личном кабинете.</p>',
                'author_id' => $admin->id,
                'type' => 'news',
                'status' => 'published',
                'is_pinned' => true,
                'views_count' => 156,
                'published_at' => Carbon::now()->subDays(5),
                'created_at' => Carbon::now()->subDays(7),
                'updated_at' => Carbon::now()->subDays(5),
            ],
            
            [
                'title' => 'Новый рекорд на дистанции 10 км',
                'slug' => 'novyi-rekord-na-distantsii-10-km',
                'excerpt' => 'Спортсмен Андрей Смирнов установил новый рекорд клуба на дистанции 10 км - 28:45.',
                'content' => '<h2>Поздравляем Андрея Смирнова!</h2>
<p>На прошедших соревнованиях "Зимний марафон" наш спортсмен установил новый рекорд клуба на дистанции 10 км.</p>
<p><strong>Результат: 28:45</strong> (предыдущий рекорд - 29:10)</p>
<p>Андрей показал отличную подготовку и волю к победе. Этот результат стал лучшим за последние 3 года в истории клуба.</p>
<p>Поздравляем Андрея и желаем дальнейших успехов!</p>
<p>Фото с награждения доступны в нашей галерее.</p>',
                'author_id' => $admin->id,
                'type' => 'news',
                'status' => 'published',
                'is_pinned' => false,
                'views_count' => 89,
                'published_at' => Carbon::now()->subDays(3),
                'created_at' => Carbon::now()->subDays(4),
                'updated_at' => Carbon::now()->subDays(3),
            ],
            
            // Анонсы мероприятий
            [
                'title' => 'Анонс: Весенний кросс "Белая тропа"',
                'slug' => 'anons-vesennii-kross-belaya-tropa',
                'excerpt' => '20 марта состоится традиционный весенний кросс "Белая тропа". Дистанции: 5км, 10км, 21км.',
                'content' => '<h2>Весенний кросс "Белая тропа"</h2>
<p>Приглашаем всех желающих принять участие в традиционном весеннем кроссе.</p>
<h3>Дата и место:</h3>
<ul>
<li><strong>Дата:</strong> 20 марта 2024 года</li>
<li><strong>Место:</strong> Лесопарк "Сосновый бор"</li>
<li><strong>Старт:</strong> 10:00</li>
</ul>
<h3>Дистанции:</h3>
<ul>
<li>5 км (любители, новички)</li>
<li>10 км (основная дистанция)</li>
<li>21 км (полумарафон для опытных спортсменов)</li>
</ul>
<h3>Регистрация:</h3>
<p>Открыта до 18 марта включительно.</p>
<p>Участие бесплатное для членов клуба.</p>
<p>Победители будут награждены кубками, медалями и призами от спонсоров.</p>',
                'author_id' => $admin->id,
                'type' => 'announcement',
                'status' => 'published',
                'is_pinned' => true,
                'views_count' => 124,
                'published_at' => Carbon::now()->subDays(2),
                'created_at' => Carbon::now()->subDays(3),
                'updated_at' => Carbon::now()->subDays(2),
            ],
            
            [
                'title' => 'Набор в детскую секцию по лыжным гонкам',
                'slug' => 'nabor-v-detskuyu-sektsiyu-po-lyzhnym-gonkam',
                'excerpt' => 'Объявляем набор детей 8-12 лет в секцию по лыжным гонкам. Занятия бесплатные.',
                'content' => '<h2>Набор в детскую секцию</h2>
<p>Спортивный клуб "Белый Лис" объявляет набор детей в возрасте 8-12 лет в секцию по лыжным гонкам.</p>
<h3>Условия:</h3>
<ul>
<li>Возраст: 8-12 лет</li>
<li>Занятия: 3 раза в неделю</li>
<li>Место: Стадион "Олимпийский"</li>
<li>Стоимость: Бесплатно (для членов клуба)</li>
</ul>
<h3>Тренерский состав:</h3>
<p>Занятия ведут опытные тренеры с высшим спортивным образованием:</p>
<ul>
<li>Иванова Мария Петровна - мастер спорта по лыжным гонкам</li>
<li>Сидоров Алексей Владимирович - заслуженный тренер области</li>
</ul>
<h3>Запись:</h3>
<p>Запись по телефону: +7 (XXX) XXX-XX-XX</p>
<p>Или через форму на сайте в разделе "Контакты".</p>
<p>Первое пробное занятие - бесплатно!</p>',
                'author_id' => $admin->id,
                'type' => 'announcement',
                'status' => 'published',
                'is_pinned' => false,
                'views_count' => 67,
                'published_at' => Carbon::now()->subDays(1),
                'created_at' => Carbon::now()->subDays(2),
                'updated_at' => Carbon::now()->subDays(1),
            ],
            
            // Статьи
            [
                'title' => 'Как подготовиться к первому забегу на 10 км',
                'slug' => 'kak-podgotovitsya-k-pervomu-zabegu-na-10-km',
                'excerpt' => 'Рекомендации для начинающих бегунов по подготовке к первому забегу на 10 километров.',
                'content' => '<h2>Подготовка к первому забегу на 10 км: пошаговое руководство</h2>
<p>Первый забег на 10 км - это важный этап для любого бегуна. Вот как правильно подготовиться:</p>
<h3>1. Планирование тренировок</h3>
<p>Оптимальный срок подготовки - 8-12 недель. Тренируйтесь 3-4 раза в неделю:</p>
<ul>
<li>1 длительная пробежка (увеличивайте дистанцию на 10% каждую неделю)</li>
<li>1-2 восстановительные пробежки</li>
<li>1 интервальная тренировка</li>
</ul>
<h3>2. Питание</h3>
<p>За 2-3 дня до забега увеличьте потребление углеводов. В день забега:</p>
<ul>
<li>Завтрак за 2-3 часа до старта</li>
<li>Легкая пища: овсянка, банан, тост</li>
<li>Избегайте жирной и тяжелой пищи</li>
</ul>
<h3>3. Оборудование</h3>
<p>Подберите правильную обувь за 2-3 недели до забега. Не берите новую экипировку в день соревнований.</p>
<h3>4. Тактика на забеге</h3>
<p>Не стартуйте слишком быстро. Держите равномерный темп. Пейте воду на пунктах питания.</p>
<p>Удачи на дистанции!</p>',
                'author_id' => $admin->id,
                'type' => 'article',
                'status' => 'published',
                'is_pinned' => false,
                'views_count' => 234,
                'published_at' => Carbon::now()->subDays(10),
                'created_at' => Carbon::now()->subDays(12),
                'updated_at' => Carbon::now()->subDays(10),
            ],
            
            [
                'title' => 'Техника классического лыжного хода: основы',
                'slug' => 'tekhnika-klassicheskogo-lyzhnogo-hoda-osnovy',
                'excerpt' => 'Основные принципы и техника классического лыжного хода для начинающих.',
                'content' => '<h2>Основы классического лыжного хода</h2>
<p>Классический ход - фундаментальная техника в лыжных гонках. Рассмотрим основные элементы:</p>
<h3>1. Положение тела</h3>
<ul>
<li>Наклон корпуса вперед</li>
<li>Спина прямая</li>
<li>Взгляд направлен на 10-15 метров вперед</li>
<li>Колени слегка согнуты</li>
</ul>
<h3>2. Работа рук</h3>
<p>Движение должно быть синхронным:</p>
<ul>
<li>Активный мах вперед</li>
<li>Отталкивание через кисть</li>
<li>Полное выпрямление руки в конечной фазе</li>
</ul>
<h3>3. Работа ног</h3>
<p>Толчок должен быть мощным и направленным:</p>
<ul>
<li>Полное отталкивание стопой</li>
<li>Выпрямление ноги в колене</li>
<li>Скольжение на опорной ноге</li>
</ul>
<h3>4. Упражнения для отработки</h3>
<p>Рекомендуемые упражнения:</p>
<ul>
<li>Без палок на равнине</li>
<li>С длинными палками</li>
<li>Подъем в гору попеременным ходом</li>
</ul>
<p>Тренируйтесь регулярно, и техника обязательно улучшится!</p>',
                'author_id' => $admin->id,
                'type' => 'article',
                'status' => 'published',
                'is_pinned' => false,
                'views_count' => 178,
                'published_at' => Carbon::now()->subDays(15),
                'created_at' => Carbon::now()->subDays(18),
                'updated_at' => Carbon::now()->subDays(15),
            ],
            
            // Черновики
            [
                'title' => 'Итоги осеннего сезона 2024 (черновик)',
                'slug' => 'itogi-osennego-sezona-2024-cherdovik',
                'excerpt' => 'Предварительные итоги осеннего сезона беговых соревнований.',
                'content' => '<h2>Итоги осеннего сезона 2024</h2>
<p>Осенний сезон был насыщенным. Проведено 8 соревнований по бегу.</p>
<p>[Здесь будут детальные результаты по мероприятиям]</p>
<p>[Нужно добавить статистику по участникам]</p>
<p>[Фото с мероприятий]</p>',
                'author_id' => $admin->id,
                'type' => 'news',
                'status' => 'draft',
                'is_pinned' => false,
                'views_count' => 0,
                'published_at' => null,
                'created_at' => Carbon::now()->subDays(1),
                'updated_at' => Carbon::now()->subDays(1),
            ],
            
            // Страницы
            [
                'title' => 'О клубе',
                'slug' => 'o-klube',
                'excerpt' => 'История и цели спортивного клуба "Белый Лис".',
                'content' => '<h1>Спортивный клуб "Белый Лис"</h1>
<h2>Наша история</h2>
<p>Клуб "Белый Лис" был основан в 2010 году группой энтузиастов спорта. Начиная с небольших любительских забегов, мы выросли в одну из крупнейших спортивных организаций региона.</p>
<h2>Наши цели</h2>
<ul>
<li>Популяризация здорового образа жизни</li>
<li>Развитие массового спорта</li>
<li>Подготовка спортсменов для участия в соревнованиях</li>
<li>Организация качественных спортивных мероприятий</li>
</ul>
<h2>Достижения</h2>
<p>За время существования клуба:</p>
<ul>
<li>Проведено более 100 соревнований</li>
<li>Участвовало более 5000 спортсменов</li>
<li>Подготовлено 15 мастеров спорта</li>
<li>Организованы детские спортивные секции</li>
</ul>
<h2>Команда</h2>
<p>Наша команда - это опытные тренеры, судьи и организаторы, посвятившие свою жизнь спорту.</p>
<p>Присоединяйтесь к нам!</p>',
                'author_id' => $admin->id,
                'type' => 'page',
                'status' => 'published',
                'is_pinned' => false,
                'views_count' => 45,
                'published_at' => Carbon::now()->subDays(30),
                'created_at' => Carbon::now()->subDays(35),
                'updated_at' => Carbon::now()->subDays(30),
            ],
            
            [
                'title' => 'Контакты',
                'slug' => 'kontakty',
                'excerpt' => 'Контактная информация спортивного клуба "Белый Лис".',
                'content' => '<h1>Контакты</h1>
<h2>Контактная информация</h2>
<p><strong>Адрес:</strong> г. Москва, ул. Спортивная, д. 15</p>
<p><strong>Телефон:</strong> +7 (495) 123-45-67</p>
<p><strong>Email:</strong> info@beliy-lis.ru</p>
<p><strong>Режим работы офиса:</strong> Пн-Пт с 10:00 до 18:00</p>
<h2>Руководство клуба</h2>
<p><strong>Директор:</strong> Иванов Петр Сергеевич</p>
<p>Телефон: +7 (495) 123-45-68</p>
<p>Email: director@beliy-lis.ru</p>
<p><strong>Главный тренер:</strong> Сидорова Ольга Владимировна</p>
<p>Телефон: +7 (495) 123-45-69</p>
<p>Email: coach@beliy-lis.ru</p>
<h2>Как добраться</h2>
<p>Офис клуба находится в 5 минутах ходьбы от станции метро "Спортивная".</p>
<p>Рядом расположена бесплатная парковка.</p>
<h2>Обратная связь</h2>
<p>По вопросам сотрудничества, спонсорства и организации мероприятий обращайтесь по указанным контактам.</p>',
                'author_id' => $admin->id,
                'type' => 'page',
                'status' => 'published',
                'is_pinned' => false,
                'views_count' => 32,
                'published_at' => Carbon::now()->subDays(30),
                'created_at' => Carbon::now()->subDays(35),
                'updated_at' => Carbon::now()->subDays(30),
            ],
            
            // Дополнительные публикации (аналогично фабрике, но явно)
            [
                'title' => 'Расписание тренировок на неделю',
                'slug' => 'raspisanie-trenirovok-na-nedelyu',
                'excerpt' => 'Актуальное расписание групповых тренировок на текущую неделю.',
                'content' => '<h2>Расписание тренировок</h2>
<p>Групповые тренировки проводятся для всех желающих:</p>
<h3>Понедельник</h3>
<ul>
<li>18:00 - Беговая тренировка (стадион)</li>
<li>19:30 - ОФП для бегунов (зал)</li>
</ul>
<h3>Среда</h3>
<ul>
<li>18:00 - Интервальная тренировка</li>
<li>19:30 - Растяжка и восстановление</li>
</ul>
<h3>Пятница</h3>
<ul>
<li>18:00 - Длительная пробежка</li>
<li>19:30 - Техника бега</li>
</ul>
<p>Присоединяйтесь к нашим тренировкам!</p>',
                'author_id' => $admin->id,
                'type' => 'announcement',
                'status' => 'published',
                'is_pinned' => false,
                'views_count' => 78,
                'published_at' => Carbon::now()->subDays(7),
                'created_at' => Carbon::now()->subDays(8),
                'updated_at' => Carbon::now()->subDays(7),
            ],
            
            [
                'title' => 'Правила безопасности на соревнованиях',
                'slug' => 'pravila-bezopasnosti-na-sorevnovaniyah',
                'excerpt' => 'Важные правила техники безопасности для участников соревнований.',
                'content' => '<h1>Правила безопасности</h1>
<p>Для обеспечения безопасности всех участников просим соблюдать следующие правила:</p>
<h2>1. Перед стартом</h2>
<ul>
<li>Пройти медицинский осмотр при наличии хронических заболеваний</li>
<li>Не употреблять алкоголь за 24 часа до старта</li>
<li>Проверить экипировку и обувь</li>
</ul>
<h2>2. На дистанции</h2>
<ul>
<li>Соблюдать правила обгона</li>
<li>Не создавать помех другим участникам</li>
<li>Следить за разметкой и указателями</li>
</ul>
<h2>3. В экстренных случаях</h2>
<ul>
<li>При травме остановиться и обратиться к волонтерам</li>
<li>Вызвать скорую помощь по телефону 112</li>
<li>Сообщить организаторам о происшествии</li>
</ul>
<p>Берегите себя и других участников!</p>',
                'author_id' => $admin->id,
                'type' => 'article',
                'status' => 'published',
                'is_pinned' => false,
                'views_count' => 92,
                'published_at' => Carbon::now()->subDays(12),
                'created_at' => Carbon::now()->subDays(15),
                'updated_at' => Carbon::now()->subDays(12),
            ],
        ];

        foreach ($publications as $publication) {
            Publication::create($publication);
        }

        $this->command->info('Создано ' . count($publications) . ' публикаций');
    }
}